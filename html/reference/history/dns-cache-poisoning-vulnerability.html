<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DNS Cache Poisoning Vulnerability (2008) &mdash; Unbound 1.19.0 ドキュメント</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="Unbound 1.0.2 Patch Announcement" href="patch-announce102.html" />
    <link rel="prev" title="Unbound Resolver Prototype" href="prototype-resolver.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/unbound-duotone-white.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.19.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases/home-resolver.html">Resolver for Home Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases/local-stub.html">Local DNS (Stub) Resolver for a Single Machine</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../topics/core/proxy.html">Downstream Proxy Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/core/serve-stale.html">Serving Stale Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/core/performance.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/core/monitoring.html">Monitoring and Reporting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../topics/privacy/aggressive-nsec.html">Aggressive NSEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/privacy/dns-over-https.html">DNS-over-HTTPS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Filtering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../topics/filtering/tags-views.html">Tags and Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/filtering/rpz.html">Response Policy Zones</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developer/libunbound-tutorial/index.html">Unbound Library Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/python-modules.html">Unbound for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/doxygen-docs.html">Source Code Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manual Pages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound.html">unbound(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-checkconf.html">unbound-checkconf(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound.conf.html">unbound.conf(5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-host.html">unbound-host(1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/libunbound.html">libunbound(3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-control.html">unbound-control(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-anchor.html">unbound-anchor(8)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rfc-compliance.html">RFC Compliance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">History</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="requirements.html">Requirements for Recursive Caching Resolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="prototype-resolver.html">Unbound Resolver Prototype</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">DNS Cache Poisoning Vulnerability (2008)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#executive-summary">Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unbound">Unbound</a></li>
<li class="toctree-l3"><a class="reference internal" href="#links">Links</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patch-announce102.html">Unbound 1.0.2 Patch Announcement</a></li>
<li class="toctree-l2"><a class="reference internal" href="book-news.html">Unbound Operation Explained in Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="info-timeout-server-selection.html">Unbound Timeout and Server Selection Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="info-algo.html">DNSSEC Algorithms with Unbound</a></li>
<li class="toctree-l2"><a class="reference internal" href="info-algo.html#trust-anchors">Trust Anchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="root-11sep-11oct.html">Trust anchor retrieval less then 30 days before the KSK rollover</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">Docs To-Do List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Unbound</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">History</a></li>
      <li class="breadcrumb-item active">DNS Cache Poisoning Vulnerability (2008)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/reference/history/dns-cache-poisoning-vulnerability.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dns-cache-poisoning-vulnerability-2008">
<h1>DNS Cache Poisoning Vulnerability (2008)<a class="headerlink" href="#dns-cache-poisoning-vulnerability-2008" title="この見出しへのパーマリンク">¶</a></h1>
<div class="line-block">
<div class="line"><em>Authored April, 2008</em></div>
<div class="line"><em>Updated and released Jul 9, 2008</em></div>
</div>
<section id="executive-summary">
<h2>Executive Summary<a class="headerlink" href="#executive-summary" title="この見出しへのパーマリンク">¶</a></h2>
<p>Dan Kaminsky of <a class="reference external" href="http://www.ioactive.com/">IOActive</a> has reported a DNS cache
poisoning vulnerability to developers of DNS caching software. The details of
this vulnerability will be explained by Kaminsky at the upcoming <a class="reference external" href="http://blackhat.com/">Black Hat
conference</a> in August.</p>
<p>A cache poisoning attack allows unauthorized third parties to inject data into a
DNS cache, the injected data may cause rerouting of traffic.</p>
<p>There is no definite solution to the form of cache poisoning described to us by
Kaminsky. Only DNSSEC will provide the measures to detect malicious data and
prevent cache poisoning.</p>
<p>However in absence of DNSSEC being sufficiently deployed to benefit, methods
exist to increase resilience against cache poisoning attacks, and Unbound has
these implemented by design.</p>
<ul class="simple">
<li><p>Unbound was designed to use the maximum amount of randomness for
query ports and does not need to be <a class="reference external" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1447">upgraded to improve resilience</a>.</p></li>
<li><p>Unbound has also been designed with a component, called the
scrubber, that sanitizes query results and does not add data to the
cache it does not trust as being authoritative.</p></li>
</ul>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="この見出しへのパーマリンク">¶</a></h2>
<p>Absent a reference to Dan Kaminsky's work we refer to other papers where the
general principle of port and query ID randomization to mitigate cache poisoning
attempts are described.</p>
<p>Recently an article appeared in <a class="reference external" href="http://www.theregister.co.uk/2008/04/15/dns_cache_poisoning/">the Register</a> where a
statement that Amit Klein made during the RSA Security conference was quoted as:</p>
<blockquote>
<div><p><em>I'm not too comfortable with the quality of the solution from the security
and predictability standpoint</em></p>
</div></blockquote>
<p>In 2007 and 2008 Klein has <a class="reference external" href="http://www.trusteer.com/research/">published</a> a
number of articles on port and query ID predictability on the website of his
company. Work started within the IETF by <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-dnsext-forgery-resilience">Hubert and van Mook</a> in 2006
already indicated that making optimal use of the full port range improves cache
forgery resilience, and recommends the use of good sources of randomness for the
choice of query IDs and ports.</p>
<p>A new strategy to improve the resilience against forgery is the <a class="reference external" href="http://tools.ietf.org/id/internet-drafts/draft-vixie-dnsext-dns0x20&quot;">work by Vixie
and Dagon</a>, that
uses the property that authoritative servers copy the query name, while
preserving case, to introduce more entropy matching queries against answers.</p>
</section>
<section id="unbound">
<h2>Unbound<a class="headerlink" href="#unbound" title="この見出しへのパーマリンク">¶</a></h2>
<p>Unbound is being designed to be a modern, secure and up-to-date name server,
that in addition to DNSSEC (the only complete solution to DNS forgery)
implements all known mechanisms to increase the resilience to forgery of cache
entries.</p>
<p>Unbound version 1.0 has implemented query id and port randomization in the
following way.</p>
<p>For each outgoing query both the query-ID and port number are set by <a class="reference external" href="http://unbound.net/documentation/doxygen/random_8c.html">routines</a> based on the ARC4
algorithm as implemented in OpenBSD. Arc4random is a pseudo random generator
based on ARC4 that addresses the problems, as Klein mentions in one of his
papers:</p>
<blockquote>
<div><p><em>Fortunately, OpenBSD also uses [[...]] the ARC4 algorithm. As such,
spoofing responses for the resolver necessitates knowing the UDP source
port, predicting the ARC4 algorithm's next output, or exploiting an
implementation bug, none of which is currently known to apply.</em></p>
</div></blockquote>
<p>To allow for the maximum number of ports to pick from randomly, Unbound uses an
advanced strategy. Ports are chosen chosen randomly from the pool of
non-allocated ports. Ports can be excluded from this pools by means of a
configuration parameter.</p>
<p>There is a small penalty for recursive name servers that will have to do a lot
of recursion. This is because there is only a limited set of slots in the socket
cache and one may need to wait before one is available.  For this penalty there
is a compensation by the use of a socket cache which helps the kernel run its
select algorithm over open file descriptors.</p>
<p>The mechanisms utilizing case preservation as described by Vixie and Dagon is
under development and can be turned on while configuring Unbound 1.0. It should
be noted though that the likely hood on false positives, which causes Unbound to
ignore an answer thinking it is under attack, is fairly high. There are
strategies to deal with these false positives that delay the response time
somewhat and are currently under investigation. We plan an implementation of
those in once we are satisfied with the behavior.</p>
<p>We believe that the scrubber safeguards against the currently publicly known cache poisoning tactics.</p>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="この見出しへのパーマリンク">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.theregister.co.uk/2008/04/15/dns_cache_poisoning/">http://www.theregister.co.uk/2008/04/15/dns_cache_poisoning/</a></p></li>
<li><p><a class="reference external" href="http://www.trusteer.com/research/">http://www.trusteer.com/research/</a>
contains various articles focused on predictability of port and query IDs</p></li>
<li><p><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-dnsext-forgery-resilience">http://tools.ietf.org/html/draft-ietf-dnsext-forgery-resilience</a></p></li>
<li><p><a class="reference external" href="http://tools.ietf.org/id/draft-vixie-dnsext-dns0x20">http://tools.ietf.org/id/draft-vixie-dnsext-dns0x20</a>
work in progress</p></li>
<li><p><a class="reference external" href="http://unbound.net/documentation/doxygen/random_8c.html">http://unbound.net/documentation/doxygen/random_8c.html</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="prototype-resolver.html" class="btn btn-neutral float-left" title="Unbound Resolver Prototype" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="patch-announce102.html" class="btn btn-neutral float-right" title="Unbound 1.0.2 Patch Announcement" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1999-2024, NLnet Labs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>