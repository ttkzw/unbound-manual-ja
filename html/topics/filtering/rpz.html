<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Response Policy Zones &mdash; Unbound 1.19.0 ドキュメント</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="Unbound Library Tutorial" href="../../developer/libunbound-tutorial/index.html" />
    <link rel="prev" title="Tags and Views" href="tags-views.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/unbound-duotone-white.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.19.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases/home-resolver.html">Resolver for Home Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases/local-stub.html">Local DNS (Stub) Resolver for a Single Machine</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/proxy.html">Downstream Proxy Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/serve-stale.html">Serving Stale Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/performance.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/monitoring.html">Monitoring and Reporting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../privacy/aggressive-nsec.html">Aggressive NSEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy/dns-over-https.html">DNS-over-HTTPS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Filtering</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tags-views.html">Tags and Views</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Response Policy Zones</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rpz-policies">RPZ Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rpz-actions">RPZ Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use-rpz-with-unbound">How to use RPZ with Unbound</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developer/libunbound-tutorial/index.html">Unbound Library Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/python-modules.html">Unbound for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/doxygen-docs.html">Source Code Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manual Pages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound.html">unbound(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-checkconf.html">unbound-checkconf(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound.conf.html">unbound.conf(5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-host.html">unbound-host(1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/libunbound.html">libunbound(3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-control.html">unbound-control(8)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manpages/unbound-anchor.html">unbound-anchor(8)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/rfc-compliance.html">RFC Compliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/history/index.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/todo.html">Docs To-Do List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Unbound</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Response Policy Zones</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/topics/filtering/rpz.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="versionadded" id="index-0">
<p><span class="versionmodified added">バージョン 1.10.0 で追加: </span>Intial release with QNAME and Response IP Address triggers</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 1.14.0 で変更: </span>Full set of RPZ triggers and actions are supported</p>
</div>
<section id="response-policy-zones">
<h1>Response Policy Zones<a class="headerlink" href="#response-policy-zones" title="この見出しへのパーマリンク">¶</a></h1>
<p>Response Policy Zones (RPZ) is a mechanism that makes it possible to define your
local policies in a standardised way and load your policies from external
sources.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="この見出しへのパーマリンク">¶</a></h2>
<p>Unbound has support for local-zone and local-data. This makes it possible to
give a custom answer back for specified domain names. It also contains the
<code class="docutils literal notranslate"><span class="pre">respip</span></code> module which makes it possible to rewrite answers containing specified
IP addresses. Although these options are heavily used by users, they are Unbound
specific. If you operate multiple resolvers from multiple vendors you have to maintain
your policies for multiple configurations, which all will have their own syntax.
Using the Unbound specific configuration also makes it challenging to consume
policies from external sources.</p>
<p>To get these external sources to work manually, you have to fetch the external
policies in the offered format, reformat it in such a way that Unbound will
understand, and keep this list up-to-date, for example using
<a class="reference internal" href="../../manpages/unbound-control.html"><span class="doc">unbound-control(8)</span></a>.</p>
<p>To automate this process in a generic, standardised way, Response Policy Zones
(RPZ) is a policy format that will work on different resolver implementations,
and that has capabilities to be directly transferred and loaded from external
sources.</p>
<p>We'll first discuss the different policies and RPZ actions with examples, and
then show how to implement RPZ in a configuration.</p>
</section>
<section id="rpz-policies">
<span id="index-1"></span><h2>RPZ Policies<a class="headerlink" href="#rpz-policies" title="この見出しへのパーマリンク">¶</a></h2>
<p>RPZ policies are formatted in DNS zone files. This makes it possible to easily
consume and keep them to up-to-date by using DNS zone transfers. Something that
Unbound is already capable of doing for its
<a class="reference internal" href="../../manpages/unbound.conf.html#authority-zone-options"><span class="std std-ref">auth-zone</span></a> feature.</p>
<p>Each policy in the policy zone consists of a trigger and an action. The trigger
describes when the policy should be applied. The action describes what action
should be taken if the policy needs to be applied. Each trigger and action
combination is defined as a Resource Record (RR) in the policy zone. The owner
of the RR states the trigger, the type and RDATA state the action.</p>
<p>Unbound supports all the RPZ policies described in the  <a class="reference external" href="https://tools.ietf.org/html/draft-vixie-dnsop-dns-rpz-00">RPZ internet draft</a>:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Trigger</p></th>
<th class="head"><p>Description and example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">QNAME</span></code></p></td>
<td><p>The query name: <code class="docutils literal notranslate"><span class="pre">example.com</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">IP</span> <span class="pre">Address</span></code></p></td>
<td><p>The IP address of the client: <code class="docutils literal notranslate"><span class="pre">24.0.2.0.192.rpz-client-ip</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Response</span> <span class="pre">IP</span> <span class="pre">Address</span></code></p></td>
<td><p>response IP address in the answer: <code class="docutils literal notranslate"><span class="pre">24.0.2.0.192.rpz-ip</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NSDNAME</span></code></p></td>
<td><p>The nameserver name: <code class="docutils literal notranslate"><span class="pre">ns.example.com.rpz-nsdname</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NSIP</span></code></p></td>
<td><p>The nameserver IP address: <code class="docutils literal notranslate"><span class="pre">24.0.2.0.192.rpz-nsip</span></code></p></td>
</tr>
</tbody>
</table>
<p>Note that the IP address encoding for RPZ triggers in the IN-ADDR.ARPA naming
convention. So <code class="docutils literal notranslate"><span class="pre">192.0.2.24</span></code> will be written as <code class="docutils literal notranslate"><span class="pre">24.2.0.192</span></code>.</p>
<p>In the implementation step we will go trough all the triggers.</p>
</section>
<section id="rpz-actions">
<span id="index-2"></span><h2>RPZ Actions<a class="headerlink" href="#rpz-actions" title="この見出しへのパーマリンク">¶</a></h2>
<p>Aside from RPZ triggers, RPZ also specifies actions as a result of these
triggers. Unbound currently supports the following actions: <strong>NXDOMAIN</strong>,
<strong>NODATA</strong>, <strong>PASSTHRU</strong>, <strong>DROP</strong>, <strong>Local Data</strong>, and <strong>TCP-only</strong>.</p>
<p>The <strong>Local Data</strong> action responds with a preconfigured resource record. Queries
for types that do not exist in the policy zones will result in a NODATA answer.</p>
<p>Other RPZ actions that are supported by Unbound are the <strong>NXDOMAIN</strong>,
<strong>NODATA</strong>, <strong>PASSTHRU</strong>, <strong>DROP</strong> and <strong>TCP-Only</strong> actions. All of these
actions are defined by having a CNAME to a specific name.</p>
<p>The CNAME targets for the other RPZ actions are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action</p></th>
<th class="head"><p>RR type and RDATA</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NXDOMAIN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CNAME</span> <span class="pre">.</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NODATA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CNAME</span> <span class="pre">*.</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PASSTHRU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CNAME</span> <span class="pre">rpz-passthru.</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DROP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CNAME</span> <span class="pre">rpz-drop.</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TCP-Only</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CNAME</span> <span class="pre">rpz-tcp-only.</span></code></p></td>
</tr>
</tbody>
</table>
<p>The <strong>NODATA</strong> action returns a response with no attached data. The <strong>DROP</strong>
action ignores (drops) the query. The <strong>TCP-Only</strong> action responds to the query
over TCP. The <strong>PASSTHRU</strong> action makes it possible to exclude a domain, or IP
address, from your policies so that if the <strong>PASSTHRU</strong> action is triggered no
other policy from any of the available policy zones will be applied.</p>
</section>
<section id="how-to-use-rpz-with-unbound">
<h2>How to use RPZ with Unbound<a class="headerlink" href="#how-to-use-rpz-with-unbound" title="この見出しへのパーマリンク">¶</a></h2>
<p>The RPZ implementation in Unbound depends on the <code class="docutils literal notranslate"><span class="pre">respip</span></code> module, this module
needs to be loaded using <a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-module-config"><span class="std std-ref">module-config:</span></a>.
Each policy zone is configured in
Unbound using the <strong>rpz:</strong> clause.
The full documentation for RPZ in Unbound can be found in the
<a class="reference internal" href="../../manpages/unbound.conf.html"><span class="doc">unbound.conf(5)</span></a>.
A minimal configuration with a single policy zone can look like the following,
where additional elements can be uncommented:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server:
    module-config: &quot;respip validator iterator&quot;
rpz:
    # The name of the RPZ authority zone
    name: rpz.nlnetlabs.nl

    # The filename where the zone is stored. If left empty
    zonefile: rpz.nlnetlabs.nl

    # The location of the remote RPZ zonefile.
    # url: http://www.example.com/example.org.zone (not a real RPZ file)

    # Always use this RPZ action for matching triggers from this zone.
    # Possible action are: nxdomain, nodata, passthru, drop, disabled,
    # and cname.
    # rpz-action-override: nxdomain

    # Log all applied RPZ actions for this RPZ zone. Default is no.
    # rpz-log: yes

    # Specify a string to be part of the log line.
    # rpz-log-name: nlnetlabs
</pre></div>
</div>
<p>In above example the policy zone will be loaded from the file
<code class="docutils literal notranslate"><span class="pre">rpz.nlnetlabs.nl</span></code>. An example RPZ file with all the triggers and actions
looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ORIGIN rpz.nlnetlabs.nl.

# QNAME trigger with local data action
example.com.rpz.nlnetlabs.nl.    TXT  &quot;trigger for example.com&quot;
*.example.com               CNAME   .

# IPv4 subnet (192.0.2.0/28) which drops clients and IPv6 subnet
(2001:db8::3/128) which is not subject to policy
28.0.2.0.192.rpz-client-ip      CNAME rpz-drop.
128.3.zz.db8.2001.rpz-client-ip CNAME rpz-passthru.
# Clients at 192.2.0.64 only get responses over TCP.
64.2.0.192.rpz-client-ip        CNAME rpz-tcp-only.

# Fills the responses for these queries with NXDOMAIN and the correct
# answers respectively
24.0.2.0.192.rpz-ip         CNAME   .
32.2.2.0.192.rpz-ip         CNAME   rpz-passthru.

# Answers queries for the nlnetlabs.nl nameserver with NXDOMAIN
ns.nlnetlabs.nl.rpz-nsdname CNAME   .

# Drops queries for the nameserver at 192.0.2.0/24 subnet
24.0.2.0.192.rpz-nsip       CNAME   rpz-drop.
</pre></div>
</div>
<p>It is also possible to load the zone using DNS zone transfers. Both AXFR and
IXFR is supported, all additions and deletion in the zone will be picked up by
Unbound and reflected in the local policies. Transferring the policy using a DNS
zone transfer is as easy as specifying the server to get the zone from:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server:
    module-config: &quot;respip validator iterator&quot;
rpz:
    name: rpz.nlnetlabs.nl
    master: &lt;ip address of server to transfer from&gt;
    zonefile: rpz.nlnetlabs.nl
</pre></div>
</div>
<p>The zone will now be transferred from the configured address and saved to a
zonefile on disk. It is possible to have more than one policy zone in Unbound.
Having multiple policy zones is as simple as having multiple <strong>rpz:</strong> clauses:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server:
    module-config: &quot;respip validator iterator&quot;
rpz:
    name: rpz.nlnetlabs.nl
    zonefile: rpz.nlnetlabs.nl
rpz:
    name: rpz2.nlnetlabs.nl
    zonefile: rpz2.nlnetlabs.nl
</pre></div>
</div>
<p>The policy zones will be applied in the configured order. In the example,
Unbound will only look at the <code class="docutils literal notranslate"><span class="pre">rpz2.nlnetlabs.nl</span></code> policies if there is no
match in the <code class="docutils literal notranslate"><span class="pre">rpz.nlnetlabs.nl</span></code> zone. If there is no match in any of the
configured zones Unbound will continue to resolve the domain by sending upstream
queries. Note that a PASSTHRU action is considered a match, having that action
in the first zone will therefore stop Unbound from looking further at other
policy zones.</p>
<p>Unbound has the possibility to override the actions that will be used for
policies in a zone that matches the zone’s triggers. This can be done using the
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-rpz-rpz-action-override"><span class="std std-ref">rpz-action-override:</span></a> configuration
option.
The possible values for the option are: <code class="docutils literal notranslate"><span class="pre">nxdomain</span></code>, <code class="docutils literal notranslate"><span class="pre">nodata</span></code>, <code class="docutils literal notranslate"><span class="pre">passthru</span></code>,
<code class="docutils literal notranslate"><span class="pre">drop</span></code>, <code class="docutils literal notranslate"><span class="pre">disabled</span></code>, and <code class="docutils literal notranslate"><span class="pre">cname</span></code>.
The first four options of this list will do the same as the RPZ actions with
the same name.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cname</span></code> override option will make it possible to apply a local data action
using a CNAME for all matching triggers in the policy zone.
The CNAME to use in the answer can be configured using the
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-rpz-rpz-cname-override"><span class="std std-ref">rpz-cname-override:</span></a> configuration
option.
Using these overrides is nice if you use an external feed to get a list of
triggers, but would like to redirect all your users to your own domain:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>RPZ zone (rpz.nlnetlabs.nl):
$ORIGIN rpz.nlnetlabs.nl.
drop.example.com.rpz.nlnetlabs.nl. CNAME rpz-drop.
32.34.216.184.93.rpz-ip.rpz.nlnetlabs.nl. A 192.0.2.1
</pre></div>
</div>
<p>This also requires a change in the Unbound configuration:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server:
    module-config: &quot;respip validator iterator&quot;

rpz:
    name: rpz.nlnetlabs.nl
    zonefile: rpz.nlnetlabs.nl
    rpz-action-override: cname
    rpz-cname-override: &quot;example.nl.&quot;
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">disabled</span></code> option will stop Unbound from applying any of the actions in
the zone. This, combined with the <code class="docutils literal notranslate"><span class="pre">rpz-log</span></code> option, is a nice way to test what
would happen to your traffic when a policy will be enabled, without directly
impacting your users. The difference between <code class="docutils literal notranslate"><span class="pre">disabled</span></code> and <code class="docutils literal notranslate"><span class="pre">passthru</span></code> is
that disabled is not considered to be a valid match and will therefore not stop
Unbound from looking at the next configured policy zone.</p>
<p>When <a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-rpz-rpz-log"><span class="std std-ref">rpz-log:</span></a> is set to yes, Unbound will log
all applied actions for a policy zone.
With <code class="docutils literal notranslate"><span class="pre">rpz-log</span></code> enabled you can specify a name for the log using
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-rpz-rpz-log-name"><span class="std std-ref">rpz-log-name:</span></a>, this way you can easily
find all matches for a specific zone.
It is also possible to get statistics per applied RPZ action using
<a class="reference internal" href="../../manpages/unbound-control.html#unbound-control-commands-stats"><span class="std std-ref">unbound-control stats</span></a> or
<a class="reference internal" href="../../manpages/unbound-control.html#unbound-control-commands-stats-noreset"><span class="std std-ref">unbound-control stats_noreset</span></a>.
This requires the <a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-extended-statistics"><span class="std std-ref">extended-statistics:</span></a>
to be enabled.</p>
<p>Unbound’s RPZ implementation works together with the tags functionality.
This makes it possible to enable (some of) the policy zones only for a subset
of users.
To do this, the tags need to be defined using
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-define-tag"><span class="std std-ref">define-tag:</span></a>, the correct tags need to be matched
either with the client IP prefix using
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-access-control-tag"><span class="std std-ref">access-control-tag:</span></a> or the clients on
a listening interface using <a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-interface-tag"><span class="std std-ref">interface-tag:</span></a>,
and the tags need to be specified for the policy zones for which they apply.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server:
    module-config: &quot;respip validator iterator&quot;
    interface: eth0
    define-tag: &quot;malware social&quot;

    # Per client IP ...
    access-control-tag: 127.0.0.10/32 &quot;social&quot;
    access-control-tag: 127.0.0.20/32 &quot;social malware&quot;
    access-control-tag: 127.0.0.30/32 &quot;malware&quot;
    # ... and/or per listening interface
    interface-tag: eth0 &quot;social&quot;

rpz:
    name: malware.rpz.example.com
    zonefile: malware.rpz.example.com
    tags: &quot;malware&quot;

rpz:
    name: social.rpz.example.com
    zonefile: social.rpz.example.com
    tags: &quot;social&quot;
</pre></div>
</div>
<p>Queries from 127.0.0.1 will not be filtered.
For queries coming from 127.0.0.10 or the eth0 interface,
only the policies from the social.rpz.example.com zone will be used.
For queries coming from 127.0.0.30 only the policies from the
malware.rpz.example.com zone will be used.
Queries coming from 127.0.0.20 will be subjected to the policies from both
zones.</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference internal" href="../../manpages/unbound.conf.html#response-policy-zone-options"><span class="std std-ref">Response Policy Zone Options</span></a>,
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-module-config"><span class="std std-ref">module-config</span></a>,
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-define-tag"><span class="std std-ref">define-tag</span></a>,
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-access-control-tag"><span class="std std-ref">access-control-tag</span></a>, and
<a class="reference internal" href="../../manpages/unbound.conf.html#unbound-conf-extended-statistics"><span class="std std-ref">extended-statistics</span></a> in the
<a class="reference internal" href="../../manpages/unbound.conf.html"><span class="doc">unbound.conf(5)</span></a> manpage.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tags-views.html" class="btn btn-neutral float-left" title="Tags and Views" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../developer/libunbound-tutorial/index.html" class="btn btn-neutral float-right" title="Unbound Library Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1999-2024, NLnet Labs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>